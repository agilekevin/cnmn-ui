<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>cnmn - Synonym Puzzle</title>
  <meta name="description" content="A free daily synonym puzzle. Decode the consonant code, find the synonym, share your score.">
  <meta property="og:title" content="cnmn - Daily Synonym Puzzle">
  <meta property="og:description" content="Decode the consonant code, find the synonym, share your score. New puzzle every day!">
  <meta property="og:image" content="https://cnmn.app/og-image.png">
  <meta property="og:url" content="https://cnmn.app">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="cnmn - Daily Synonym Puzzle">
  <meta name="twitter:description" content="Decode the consonant code, find the synonym, share your score.">
  <meta name="twitter:image" content="https://cnmn.app/og-image.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32.png">
  <link rel="apple-touch-icon" sizes="180x180" href="favicon.png">
  <link rel="alternate" type="application/rss+xml" title="cnmn" href="https://cnmn.app/feed.xml">
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: 'Libre Baskerville', Georgia, serif;
    }
    #root {
      width: 100%;
      min-height: 100vh;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- React & ReactDOM from CDN -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel Standalone for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Your React Component -->
  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    // ============================================
    // PUZZLE DATA - Auto-updated by GitHub Action
    // ============================================
    // DO NOT EDIT MANUALLY - This is replaced by the
    // publish-puzzle workflow with each day's puzzle
    // ============================================
    // __PUZZLE_DATA_START__
    const CHAIN_DATA = {
          "number": 780,
          "date": "Wednesday",
          "links": [
                {
                      "category": "Cold",
                      "options": [
                            "frj",
                            "frzn",
                            "forgd",
                            "frgd"
                      ],
                      "answer": "frgd",
                      "decoded": "FRIGID",
                      "decodedOptions": {
                            "frgd": "FRIGID",
                            "frzn": "FROZEN",
                            "frj": "FRIDGE",
                            "forgd": "FORGED"
                      },
                      "emoji": "ðŸ¥¶",
                      "bridge": null
                },
                {
                      "category": "Hat",
                      "options": [
                            "bnd",
                            "brm",
                            "bnnt",
                            "bn"
                      ],
                      "answer": "bn",
                      "decoded": "BEANIE",
                      "decodedOptions": {
                            "bn": "BEANIE",
                            "bnnt": "BONNET",
                            "brm": "BRIM",
                            "bnd": "BAND"
                      },
                      "emoji": "ðŸ§¢",
                      "bridge": null
                },
                {
                      "category": "Gloves",
                      "options": [
                            "mtns",
                            "nttng",
                            "mttns",
                            "bttns"
                      ],
                      "answer": "mttns",
                      "decoded": "MITTENS",
                      "decodedOptions": {
                            "mttns": "MITTENS",
                            "nttng": "KNITTING",
                            "bttns": "BUTTONS",
                            "mtns": "MATINS"
                      },
                      "emoji": "ðŸ§¤",
                      "bridge": null
                },
                {
                      "category": "Jacket",
                      "options": [
                            "pkt",
                            "prks",
                            "prk",
                            "prik"
                      ],
                      "answer": "prk",
                      "decoded": "PARKA",
                      "decodedOptions": {
                            "prk": "PARKA",
                            "pkt": "POCKET",
                            "prks": "PARKS",
                            "prik": "PRICK"
                      },
                      "emoji": "ðŸ§¥",
                      "bridge": null
                },
                {
                      "category": "Cozy",
                      "options": [
                            "sft",
                            "snag",
                            "sng",
                            "sung"
                      ],
                      "answer": "sng",
                      "decoded": "SNUG",
                      "decodedOptions": {
                            "sng": "SNUG",
                            "snag": "SNAG",
                            "sft": "SOFT",
                            "sung": "SUNG"
                      },
                      "emoji": "â˜•",
                      "bridge": null
                },
                {
                      "category": "Scarf",
                      "options": [
                            "swtr",
                            "mfflr",
                            "rffld",
                            "mffns"
                      ],
                      "answer": "mfflr",
                      "decoded": "MUFFLER",
                      "decodedOptions": {
                            "mfflr": "MUFFLER",
                            "rffld": "RUFFLED",
                            "swtr": "SWEATER",
                            "mffns": "MUFFINS"
                      },
                      "emoji": "ðŸ§£",
                      "bridge": null
                }
          ]
    };
    // __PUZZLE_DATA_END__

    // Audio feedback using Web Audio API
    const useAudio = () => {
      const audioContextRef = useRef(null);

      const getContext = () => {
        if (!audioContextRef.current) {
          audioContextRef.current = new (window.AudioContext || window.webkitAudioContext)();
        }
        return audioContextRef.current;
      };

      const playCorrect = () => {
        try {
          const ctx = getContext();
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();

          osc.connect(gain);
          gain.connect(ctx.destination);

          osc.frequency.setValueAtTime(523.25, ctx.currentTime);
          osc.frequency.setValueAtTime(659.25, ctx.currentTime + 0.1);
          osc.frequency.setValueAtTime(783.99, ctx.currentTime + 0.2);

          gain.gain.setValueAtTime(0.3, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.4);

          osc.start(ctx.currentTime);
          osc.stop(ctx.currentTime + 0.4);
        } catch (e) {
          console.log('Audio not available');
        }
      };

      const playWrong = () => {
        try {
          const ctx = getContext();
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();

          osc.connect(gain);
          gain.connect(ctx.destination);

          osc.frequency.setValueAtTime(200, ctx.currentTime);
          osc.frequency.setValueAtTime(150, ctx.currentTime + 0.1);

          gain.gain.setValueAtTime(0.3, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);

          osc.start(ctx.currentTime);
          osc.stop(ctx.currentTime + 0.2);
        } catch (e) {
          console.log('Audio not available');
        }
      };

      const playComplete = () => {
        try {
          const ctx = getContext();
          const notes = [523.25, 659.25, 783.99, 1046.50];

          notes.forEach((freq, i) => {
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();

            osc.connect(gain);
            gain.connect(ctx.destination);

            osc.frequency.setValueAtTime(freq, ctx.currentTime + i * 0.15);
            gain.gain.setValueAtTime(0.3, ctx.currentTime + i * 0.15);
            gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + i * 0.15 + 0.3);

            osc.start(ctx.currentTime + i * 0.15);
            osc.stop(ctx.currentTime + i * 0.15 + 0.3);
          });
        } catch (e) {
          console.log('Audio not available');
        }
      };

      return { playCorrect, playWrong, playComplete };
    };

    const formatTime = (seconds) => {
      const mins = Math.floor(seconds / 60);
      const secs = seconds % 60;
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    };

    const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';

    // Streak tracking via localStorage
    const getStreak = () => {
      try {
        return JSON.parse(localStorage.getItem('cnmn-streak') || '{}');
      } catch { return {}; }
    };

    const recordPlay = (puzzleNumber) => {
      const streak = getStreak();
      if (streak.lastPuzzle === puzzleNumber) return streak; // already recorded

      const isConsecutive = streak.lastPuzzle === puzzleNumber - 1;
      const current = isConsecutive ? (streak.current || 0) + 1 : 1;
      const best = Math.max(current, streak.best || 0);
      const updated = { lastPuzzle: puzzleNumber, current, best };
      localStorage.setItem('cnmn-streak', JSON.stringify(updated));
      return updated;
    };

    function LocalBadge() {
      return (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          width: '100px',
          height: '100px',
          overflow: 'hidden',
          zIndex: 9999,
          pointerEvents: 'none',
        }}>
          {/* Folded corner */}
          <div style={{
            position: 'absolute',
            top: 0,
            left: 0,
            width: 0,
            height: 0,
            borderStyle: 'solid',
            borderWidth: '70px 70px 0 0',
            borderColor: '#e8c49a transparent transparent transparent',
            filter: 'drop-shadow(2px 2px 4px rgba(0,0,0,0.3))',
          }} />
          {/* Fold shadow */}
          <div style={{
            position: 'absolute',
            top: 0,
            left: 0,
            width: 0,
            height: 0,
            borderStyle: 'solid',
            borderWidth: '70px 70px 0 0',
            borderColor: 'rgba(0,0,0,0.08) transparent transparent transparent',
            transform: 'translate(3px, 3px)',
          }} />
          {/* Text */}
          <div style={{
            position: 'absolute',
            top: '18px',
            left: '6px',
            fontSize: '11px',
            fontWeight: '700',
            color: '#6b3410',
            textTransform: 'uppercase',
            letterSpacing: '1px',
            transform: 'rotate(-45deg)',
            transformOrigin: 'center',
          }}>local</div>
        </div>
      );
    }

    function CNMN() {
      const [currentLink, setCurrentLink] = useState(0);
      const [eliminated, setEliminated] = useState([]);
      const [misses, setMisses] = useState(0);
      const [missedLinks, setMissedLinks] = useState([]);
      const [solved, setSolved] = useState(false);
      const [showReveal, setShowReveal] = useState(false);
      const [startTime] = useState(Date.now());
      const [endTime, setEndTime] = useState(null);
      const [shakeOption, setShakeOption] = useState(null);
      const [copied, setCopied] = useState(false);
      const [solvedLinks, setSolvedLinks] = useState([]);
      const revealTimerRef = useRef(null);
      const [reviewLink, setReviewLink] = useState(null);
      const eliminatedPerLink = useRef({});
      const [streak, setStreak] = useState(() => getStreak());
      const [announcement, setAnnouncement] = useState('');

      const advanceFromReveal = () => {
        if (!showReveal) return;
        if (revealTimerRef.current) {
          clearTimeout(revealTimerRef.current);
          revealTimerRef.current = null;
        }
        if (currentLink < chain.links.length - 1) {
          setShowReveal(false);
          setCurrentLink(currentLink + 1);
          setEliminated([]);
        } else {
          setEndTime(Date.now());
          setSolved(true);
          setStreak(recordPlay(chain.number));
          playComplete();
        }
      };

      const [showHelp, setShowHelp] = useState(() => {
        return localStorage.getItem('cnmn-help-dismissed') !== 'true';
      });

      const dismissHelp = () => {
        localStorage.setItem('cnmn-help-dismissed', 'true');
        setShowHelp(false);
      };

      const { playCorrect, playWrong, playComplete } = useAudio();

      const chain = CHAIN_DATA;
      const link = chain.links[currentLink];

      // Render image or emoji fallback
      const LinkImage = ({ link: l, size }) => {
        const sizeMap = {
          tiny:   { width: 44,  height: 44,  fontSize: '24px' },
          small:  { width: 52,  height: 52,  fontSize: '28px' },
          medium: { width: 100, height: 100, fontSize: '60px' },
          large:  { width: 220, height: 220, fontSize: '120px' },
        };
        const s = sizeMap[size] || sizeMap.small;
        if (l.imageUrl) {
          return React.createElement('img', {
            src: l.imageUrl,
            alt: l.decoded || '',
            style: { width: s.width, height: s.height, objectFit: 'contain', display: 'block' },
          });
        }
        return React.createElement('span', {
          style: { fontSize: s.fontSize, lineHeight: 1 },
        }, l.emoji);
      };

      const handleGuess = (option) => {
        if (eliminated.includes(option) || showReveal) return;

        if (option === link.answer) {
          playCorrect();
          setAnnouncement(`Correct! The answer is ${link.decoded}.`);
          eliminatedPerLink.current[currentLink] = [...eliminated];
          setSolvedLinks([...solvedLinks, currentLink]);
          setShowReveal(true);

          if (currentLink < chain.links.length - 1) {
            revealTimerRef.current = setTimeout(() => {
              revealTimerRef.current = null;
              setShowReveal(false);
              setCurrentLink(currentLink + 1);
              setEliminated([]);
            }, 3000);
          } else {
            revealTimerRef.current = setTimeout(() => {
              revealTimerRef.current = null;
              setEndTime(Date.now());
              setSolved(true);
              setStreak(recordPlay(chain.number));
              playComplete();
            }, 3000);
          }
        } else {
          playWrong();
          setAnnouncement(`Wrong. ${link.decodedOptions ? link.decodedOptions[option] + ' is not correct.' : 'Try again.'}`);
          setShakeOption(option);
          setEliminated([...eliminated, option]);
          setMisses(misses + 1);
          if (!missedLinks.includes(currentLink)) {
            setMissedLinks([...missedLinks, currentLink]);
          }
          setTimeout(() => setShakeOption(null), 300);
        }
      };

      const getShareText = () => {
        const elapsed = Math.floor((endTime - startTime) / 1000);
        const chainVisual = chain.links.map((_, i) =>
          missedLinks.includes(i) ? 'â—‹' : 'â—'
        ).join('');

        const streakText = streak.current > 1 ? ` | ${streak.current} day streak` : '';
        return `cnmn #${chain.number}\n${chainVisual}\n${formatTime(elapsed)} | ${misses} missed${streakText}\nhttps://cnmn.app`;
      };

      const handleShare = async () => {
        const text = getShareText();
        if (navigator.share) {
          try {
            await navigator.share({ text });
            return;
          } catch (e) {
            if (e.name === 'AbortError') return;
          }
        }
        try {
          await navigator.clipboard.writeText(text);
          setCopied(true);
          setTimeout(() => setCopied(false), 2000);
        } catch (e) {
          console.log('Copy failed');
        }
      };

      const elapsed = solved
        ? Math.floor((endTime - startTime) / 1000)
        : Math.floor((Date.now() - startTime) / 1000);

      // Results screen
      if (solved) {
        return (
          <div style={styles.container}>
            {isLocalhost && <LocalBadge />}
            <div style={styles.resultsCard} role="main">
              <div style={styles.resultsHeader}>
                <h1 style={{...styles.logo, margin: 0}}>cnmn</h1>
                <span style={styles.puzzleNum}>#{chain.number}</span>
              </div>

              <div style={styles.chainImagesComplete}>
                {chain.links.map((l, i) => (
                  <React.Fragment key={i}>
                    <div
                      className="chainImageWrapperSmall"
                      style={{
                        ...styles.chainImageWrapperSmall,
                        ...(l.imageUrl ? {} : styles.emojiContainer),
                        borderColor: missedLinks.includes(i) ? '#d4a574' : '#6b3410'
                      }}
                    >
                      <LinkImage link={l} size="small" />
                    </div>
                    {i < chain.links.length - 1 && (
                      <div style={styles.chainConnector}>â†’</div>
                    )}
                  </React.Fragment>
                ))}
              </div>
              {chain.links.some(l => l.imageUrl && l.imageCredit) && (
                <div style={styles.iconAttribution}>
                  Icons:{' '}
                  {[...new Set(chain.links
                    .filter(l => l.imageUrl && l.imageCredit)
                    .map(l => JSON.stringify({ name: l.imageCredit.name, url: l.imageCredit.profileUrl }))
                  )].map((s, i, arr) => {
                    const c = JSON.parse(s);
                    return (
                      <React.Fragment key={i}>
                        <a href={c.url}
                          target="_blank" rel="noopener noreferrer"
                          style={styles.attributionLink}>
                          {c.name}
                        </a>
                        {i < arr.length - 1 ? ', ' : ''}
                      </React.Fragment>
                    );
                  })}
                </div>
              )}

              <div className="statsRow" style={styles.statsRow}>
                <div style={styles.stat}>
                  <div className="statValue" style={styles.statValue}>{formatTime(elapsed)}</div>
                  <div style={styles.statLabel}>time</div>
                </div>
                <div style={styles.statDivider} />
                <div style={styles.stat}>
                  <div className="statValue" style={styles.statValue}>{misses}</div>
                  <div style={styles.statLabel}>missed</div>
                </div>
                {streak.current > 1 && <>
                  <div style={styles.statDivider} />
                  <div style={styles.stat}>
                    <div className="statValue" style={styles.statValue}>{streak.current}</div>
                    <div style={styles.statLabel}>streak</div>
                  </div>
                </>}
              </div>

              <button style={styles.shareButton} onClick={handleShare} aria-label={copied ? 'Score copied to clipboard' : 'Share your score'}>
                {copied ? 'Copied!' : 'Share'}
              </button>

              <form
                action="https://buttondown.com/api/emails/embed-subscribe/cnmn"
                method="post"
                target="popupwindow"
                style={styles.newsletterForm}
              >
                <div style={styles.newsletterLabel}>Get the daily puzzle in your inbox</div>
                <div className="newsletterRow" style={styles.newsletterRow}>
                  <input
                    type="email"
                    name="email"
                    placeholder="you@email.com"
                    required
                    aria-label="Email address for newsletter"
                    style={styles.newsletterInput}
                  />
                  <button type="submit" style={styles.newsletterButton}>Subscribe</button>
                </div>
                <div style={styles.newsletterNote}>
                  Free daily email via{' '}
                  <a href="https://buttondown.com/cnmn" target="_blank" rel="noopener noreferrer" style={styles.attributionLink}>
                    Buttondown
                  </a>
                </div>
              </form>

              <div style={styles.answersReview}>
                <h2 style={{...styles.reviewTitle, margin: 0}}>Answers</h2>
                <div style={styles.reviewStartCategory}>{chain.links[0].category}</div>
                {chain.links.map((l, i) => (
                  <div key={i} style={styles.reviewItem}>
                    <span style={styles.reviewAnswer}>{l.decoded}</span>
                    {l.bridge && <span style={styles.reviewBridge}>{l.bridge}</span>}
                  </div>
                ))}
              </div>
            </div>
          </div>
        );
      }

      // Game screen
      return (
        <div style={styles.container} role="main">
          {isLocalhost && <LocalBadge />}
          <div aria-live="polite" aria-atomic="true" style={{position:'absolute',width:1,height:1,overflow:'hidden',clip:'rect(0,0,0,0)'}}>{announcement}</div>
          <div style={styles.header}>
            <h1 style={{...styles.logo, margin: 0}}>cnmn</h1>
            <div style={styles.headerRight}>
              <span style={styles.puzzleInfo}>#{chain.number} Â· {chain.date}</span>
              <button
                style={styles.helpButton}
                onClick={() => setShowHelp(!showHelp)}
                aria-label="How to play"
                aria-expanded={showHelp}
              >?</button>
            </div>
          </div>

          {/* How to Play */}
          {showHelp && (
            <div style={styles.helpBox}>
              <div style={styles.helpTitle}>How to Play</div>
              <div style={styles.helpText}>
                Find the synonym! Answers are disguised as phonetic codesâ€”sound them out.
              </div>
              <div style={styles.helpExample}>
                <span style={styles.helpPrompt}>shed</span>
                <span style={styles.helpArrow}>â†’</span>
                <span style={styles.helpCode}>grj</span>
                <span style={styles.helpArrow}>=</span>
                <span style={styles.helpAnswer}>GARAGE</span>
              </div>
              <button style={styles.helpDismiss} onClick={dismissHelp}>Got it!</button>
            </div>
          )}

          {/* Progress */}
          <div style={styles.imageChain} role="group" aria-label={`Progress: ${solvedLinks.length} of ${chain.links.length} solved`}>
            {solvedLinks.map((linkIdx) => {
              const sl = chain.links[linkIdx];
              return (
              <React.Fragment key={linkIdx}>
                <div className="chainImageWrapperTiny" style={{...styles.chainImageWrapperTiny, ...(sl.imageUrl ? {} : styles.emojiContainer), cursor: 'pointer'}}
                  onClick={() => { if (!showReveal) setReviewLink(linkIdx); }}>
                  <LinkImage link={sl} size="tiny" />
                </div>
                <div style={styles.chainConnectorTiny}>â†’</div>
              </React.Fragment>
              );
            })}
            {solvedLinks.length < chain.links.length && (
              <div style={{...styles.chainPlaceholder, ...(reviewLink !== null ? {cursor: 'pointer', borderColor: '#6b3410', color: '#6b3410'} : {})}}
                onClick={() => { if (reviewLink !== null) setReviewLink(null); }}>?</div>
            )}
          </div>

          {/* Review a previous link */}
          {reviewLink !== null && (() => {
            const rl = chain.links[reviewLink];
            const rlEliminated = eliminatedPerLink.current[reviewLink] || [];
            return (
              <div style={styles.mainArea}>
                <div style={styles.revealContainer} onClick={() => setReviewLink(null)}>
                  <div style={{...styles.imageReveal, ...(rl.imageUrl ? {} : styles.emojiContainer)}}>
                    <LinkImage link={rl} size="large" />
                  </div>
                  <div className="revealWord" style={styles.revealWord}>{rl.decoded}</div>
                  {rl.decodedOptions && (
                    <div className="revealOthers" style={styles.revealOthers}>
                      {rl.options.filter(o => o !== rl.answer).map(option => {
                        const wasEliminated = rlEliminated.includes(option);
                        return (
                          <div key={option} style={{
                            ...styles.revealOtherItem,
                            ...(wasEliminated ? styles.revealOtherEliminated : {})
                          }}>
                            <span style={styles.revealOtherCode}>{option}</span>
                            <span style={styles.revealOtherWord}>{rl.decodedOptions[option]}</span>
                            {wasEliminated && <span style={styles.revealOtherX}>âœ—</span>}
                          </div>
                        );
                      })}
                    </div>
                  )}
                  <div style={styles.reviewBackHint}>tap to go back</div>
                </div>
              </div>
            );
          })()}

          {/* Main content area */}
          {reviewLink === null && <div style={styles.mainArea}>
            {showReveal ? (
              <div style={styles.revealContainer} onClick={advanceFromReveal}>
                <div style={{...styles.imageReveal, ...(link.imageUrl ? {} : styles.emojiContainer)}}>
                  <LinkImage link={link} size="large" />
                </div>
                <div className="revealWord" style={styles.revealWord}>{link.decoded}</div>
                {link.decodedOptions && (
                  <div style={styles.revealOthers}>
                    {link.options.filter(o => o !== link.answer).map(option => {
                      const wasEliminated = eliminated.includes(option);
                      return (
                        <div key={option} style={{
                          ...styles.revealOtherItem,
                          ...(wasEliminated ? styles.revealOtherEliminated : {})
                        }}>
                          <span style={styles.revealOtherCode}>{option}</span>
                          <span style={styles.revealOtherWord}>{link.decodedOptions[option]}</span>
                          {wasEliminated && <span style={styles.revealOtherX}>âœ—</span>}
                        </div>
                      );
                    })}
                  </div>
                )}
                {link.imageUrl && link.imageCredit && (
                  <div style={styles.revealAttribution}>
                    Icon:{' '}
                    <a href={link.imageCredit.profileUrl}
                      target="_blank" rel="noopener noreferrer"
                      style={styles.attributionLink}>
                      {link.imageCredit.name}
                    </a>
                  </div>
                )}
              </div>
            ) : (
              <>
                <div style={styles.categoryContainer}>
                  <div style={styles.categoryLabel}>Find the synonym</div>
                  <div style={styles.category}>{link.category}</div>
                </div>

                <div style={styles.options} role="group" aria-label={`Choose the synonym for ${link.category}`}>
                  {link.options.map((option) => {
                    const isEliminated = eliminated.includes(option);
                    const isShaking = shakeOption === option;
                    const showDecoded = link.decodedOptions && isEliminated;

                    return (
                      <button
                        key={option}
                        className="optionBtn"
                        style={{
                          ...styles.option,
                          ...(isEliminated ? styles.optionEliminated : {}),
                          ...(isShaking ? styles.optionShake : {})
                        }}
                        onClick={() => handleGuess(option)}
                        disabled={isEliminated || showReveal}
                        aria-label={`${option}${showDecoded ? ', ' + link.decodedOptions[option] + ', eliminated' : ''}`}
                      >
                        {option}
                        {showDecoded && (
                          React.createElement('span', { style: styles.decodedLabel }, link.decodedOptions[option])
                        )}
                      </button>
                    );
                  })}
                </div>
              </>
            )}
          </div>}

          <div style={styles.footer}>
            <span style={styles.missCount}>
              {misses > 0 ? `${misses} missed` : ''}
            </span>
          </div>
        </div>
      );
    }

    const styles = {
      container: {
        minHeight: '100vh',
        background: 'linear-gradient(165deg, #fdfbf7 0%, #f5e6d3 50%, #ecdbc8 100%)',
        fontFamily: "'Libre Baskerville', Georgia, serif",
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        padding: '32px 20px',
        boxSizing: 'border-box',
      },
      header: {
        display: 'flex',
        justifyContent: 'space-between',
        alignItems: 'baseline',
        width: '100%',
        maxWidth: '420px',
        marginBottom: '24px',
      },
      logo: {
        fontSize: '36px',
        fontWeight: '700',
        color: '#6b3410',
        letterSpacing: '6px',
        textShadow: '0 2px 4px rgba(107, 52, 16, 0.1)',
      },
      puzzleInfo: {
        fontSize: '13px',
        color: '#8b6340',
        letterSpacing: '0.5px',
      },
      headerRight: {
        display: 'flex',
        alignItems: 'center',
        gap: '12px',
      },
      helpButton: {
        width: '44px',
        height: '44px',
        borderRadius: '50%',
        border: '2px solid #c4a574',
        backgroundColor: 'transparent',
        color: '#8b6340',
        fontSize: '16px',
        fontWeight: '700',
        cursor: 'pointer',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        padding: 0,
        boxShadow: 'none',
      },

      // How to Play
      helpBox: {
        width: '100%',
        maxWidth: '420px',
        backgroundColor: 'rgba(255, 255, 255, 0.95)',
        borderRadius: '14px',
        padding: '20px',
        marginBottom: '20px',
        border: '2px solid #c4a574',
        boxShadow: '0 4px 16px rgba(107, 52, 16, 0.12)',
        textAlign: 'center',
      },
      helpTitle: {
        fontSize: '14px',
        fontWeight: '700',
        color: '#6b3410',
        textTransform: 'uppercase',
        letterSpacing: '2px',
        marginBottom: '12px',
      },
      helpText: {
        fontSize: '14px',
        color: '#8b6340',
        lineHeight: '1.5',
        marginBottom: '16px',
      },
      helpExample: {
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        gap: '10px',
        marginBottom: '16px',
        flexWrap: 'wrap',
      },
      helpPrompt: {
        fontSize: '16px',
        fontStyle: 'italic',
        color: '#6b3410',
      },
      helpArrow: {
        fontSize: '14px',
        color: '#b8956d',
      },
      helpAnswer: {
        fontSize: '16px',
        fontWeight: '600',
        fontFamily: "'IBM Plex Mono', monospace",
        color: '#6b3410',
        letterSpacing: '1px',
      },
      helpCode: {
        fontSize: '18px',
        fontWeight: '600',
        fontFamily: "'IBM Plex Mono', monospace",
        color: '#6b3410',
        backgroundColor: '#f5e6d3',
        padding: '4px 10px',
        borderRadius: '6px',
        letterSpacing: '1px',
      },
      helpDismiss: {
        padding: '10px 24px',
        fontSize: '13px',
        fontFamily: "'Libre Baskerville', Georgia, serif",
        fontWeight: '600',
        backgroundColor: '#6b3410',
        color: '#fdfbf7',
        border: 'none',
        borderRadius: '8px',
        cursor: 'pointer',
        letterSpacing: '1px',
      },

      // Progress at top
      imageChain: {
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        gap: '6px',
        marginBottom: '32px',
        minHeight: '52px',
        flexWrap: 'wrap',
      },
      chainImageWrapperTiny: {
        width: '44px',
        height: '44px',
        borderRadius: '10px',
        overflow: 'hidden',
        border: '2.5px solid #6b3410',
        boxShadow: '0 3px 12px rgba(107, 52, 16, 0.25), 0 1px 4px rgba(107, 52, 16, 0.15)',
        transition: 'transform 0.2s ease',
      },
      emojiTiny: {
        fontSize: '24px',
        lineHeight: 1,
      },
      chainConnectorTiny: {
        color: '#b8956d',
        fontSize: '18px',
        fontWeight: '600',
        opacity: '0.8',
      },
      chainPlaceholder: {
        width: '44px',
        height: '44px',
        borderRadius: '10px',
        border: '2.5px dashed #c4a574',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        color: '#c4a574',
        fontSize: '22px',
        fontWeight: '700',
        backgroundColor: 'rgba(255, 255, 255, 0.4)',
      },

      // Main area
      mainArea: {
        flex: 1,
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        justifyContent: 'center',
        width: '100%',
        maxWidth: '420px',
      },

      // Reveal animation
      revealContainer: {
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        animation: 'popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)',
        cursor: 'pointer',
      },
      imageReveal: {
        width: '220px',
        height: '220px',
        borderRadius: '20px',
        overflow: 'hidden',
        border: '4px solid #6b3410',
        boxShadow: '0 12px 40px rgba(107, 52, 16, 0.35), 0 4px 12px rgba(107, 52, 16, 0.2)',
        marginBottom: '20px',
      },
      emojiLarge: {
        fontSize: '120px',
        lineHeight: 1,
        animation: 'scaleIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)',
      },
      revealWord: {
        fontSize: '32px',
        fontWeight: '700',
        color: '#6b3410',
        letterSpacing: '4px',
        fontFamily: "'IBM Plex Mono', monospace",
        textShadow: '0 2px 8px rgba(107, 52, 16, 0.1)',
        animation: 'fadeInUp 0.5s ease 0.2s backwards',
      },

      categoryContainer: {
        textAlign: 'center',
        marginBottom: '48px',
        minHeight: '90px',
        display: 'flex',
        flexDirection: 'column',
        justifyContent: 'center',
        alignItems: 'center',
        animation: 'fadeIn 0.4s ease',
        gap: '16px',
      },
      categoryLabel: {
        fontSize: '13px',
        color: '#8b6340',
        marginBottom: '10px',
        textTransform: 'uppercase',
        letterSpacing: '2.5px',
        fontWeight: '600',
      },
      category: {
        fontSize: '36px',
        fontWeight: '400',
        color: '#6b3410',
        fontStyle: 'italic',
        lineHeight: '1.3',
      },
      previousEmojiContainer: {
        width: '100px',
        height: '100px',
        borderRadius: '16px',
        border: '3px solid #6b3410',
        boxShadow: '0 4px 16px rgba(107, 52, 16, 0.25)',
      },
      emojiMedium: {
        fontSize: '60px',
        lineHeight: 1,
      },
      previousAnswer: {
        fontSize: '36px',
        fontWeight: '700',
        color: '#6b3410',
        letterSpacing: '4px',
        fontFamily: "'IBM Plex Mono', monospace",
        textShadow: '0 2px 4px rgba(107, 52, 16, 0.08)',
      },
      options: {
        display: 'grid',
        gridTemplateColumns: '1fr 1fr',
        gap: '14px',
        width: '100%',
        maxWidth: '420px',
      },
      option: {
        padding: '24px 20px',
        fontSize: '24px',
        fontFamily: "'IBM Plex Mono', monospace",
        fontWeight: '600',
        backgroundColor: '#ffffff',
        border: '3px solid #6b3410',
        borderRadius: '14px',
        cursor: 'pointer',
        transition: 'all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275)',
        color: '#6b3410',
        letterSpacing: '1.5px',
        boxShadow: '0 5px 0 #8b4513, 0 8px 20px rgba(107, 52, 16, 0.15)',
        position: 'relative',
      },
      optionEliminated: {
        backgroundColor: '#f0e4d3',
        borderColor: '#c4a574',
        color: '#8b6340',
        cursor: 'default',
        boxShadow: 'none',
        transform: 'translateY(5px)',
        opacity: '0.75',
      },
      optionShake: {
        animation: 'shake 0.35s ease',
      },
      decodedLabel: {
        display: 'block',
        fontSize: '12px',
        fontFamily: "'Libre Baskerville', Georgia, serif",
        letterSpacing: '0.5px',
        marginTop: '4px',
        opacity: 0.7,
      },
      footer: {
        marginTop: '40px',
        height: '28px',
      },
      missCount: {
        fontSize: '14px',
        color: '#8b6340',
        letterSpacing: '0.5px',
      },

      // Results styles
      resultsCard: {
        width: '100%',
        maxWidth: '420px',
        textAlign: 'center',
        animation: 'fadeIn 0.5s ease',
      },
      resultsHeader: {
        display: 'flex',
        justifyContent: 'center',
        alignItems: 'baseline',
        gap: '14px',
        marginBottom: '28px',
      },
      puzzleNum: {
        fontSize: '18px',
        color: '#8b6340',
        letterSpacing: '0.5px',
      },
      chainImagesComplete: {
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        gap: '8px',
        marginBottom: '40px',
        flexWrap: 'wrap',
        padding: '20px',
        backgroundColor: 'rgba(255, 255, 255, 0.5)',
        borderRadius: '16px',
      },
      chainImageWrapperSmall: {
        width: '52px',
        height: '52px',
        borderRadius: '12px',
        overflow: 'hidden',
        border: '3px solid',
        boxShadow: '0 3px 12px rgba(107, 52, 16, 0.25)',
        transition: 'transform 0.2s ease',
      },
      emojiContainer: {
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'center',
        backgroundColor: '#ffffff',
      },
      iconAttribution: {
        fontSize: '11px',
        color: '#b8956d',
        textAlign: 'center',
        marginTop: '8px',
        lineHeight: '1.4',
      },
      revealOthers: {
        display: 'flex',
        gap: '10px',
        marginTop: '16px',
        animation: 'fadeInUp 0.5s ease 0.3s backwards',
      },
      revealOtherItem: {
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        padding: '8px 12px',
        borderRadius: '8px',
        backgroundColor: 'rgba(255,255,255,0.6)',
        border: '2px solid #ecdbc8',
        minWidth: '70px',
      },
      revealOtherEliminated: {
        backgroundColor: 'rgba(212,165,116,0.15)',
        borderColor: '#d4a574',
      },
      revealOtherCode: {
        fontSize: '14px',
        fontFamily: "'IBM Plex Mono', monospace",
        fontWeight: '600',
        color: '#8b6340',
        letterSpacing: '1px',
      },
      revealOtherWord: {
        fontSize: '11px',
        color: '#8b6340',
        marginTop: '2px',
      },
      revealOtherX: {
        fontSize: '12px',
        color: '#c4724c',
        marginTop: '2px',
      },
      reviewBackHint: {
        fontSize: '12px',
        color: '#b8956d',
        marginTop: '16px',
        letterSpacing: '0.5px',
      },
      revealAttribution: {
        fontSize: '11px',
        color: '#b8956d',
        textAlign: 'center',
        marginTop: '6px',
        animation: 'fadeIn 0.4s ease 0.3s backwards',
      },
      attributionLink: {
        color: '#8b6340',
        textDecoration: 'none',
      },
      emojiSmall: {
        fontSize: '28px',
        lineHeight: 1,
      },
      chainConnector: {
        color: '#b8956d',
        fontSize: '20px',
        fontWeight: '700',
        opacity: '0.8',
      },
      statsRow: {
        display: 'flex',
        justifyContent: 'center',
        alignItems: 'center',
        gap: '40px',
        marginBottom: '36px',
      },
      stat: {
        textAlign: 'center',
      },
      statValue: {
        fontSize: '40px',
        fontWeight: '700',
        color: '#6b3410',
        fontFamily: "'IBM Plex Mono', monospace",
        textShadow: '0 2px 4px rgba(107, 52, 16, 0.1)',
      },
      statLabel: {
        fontSize: '11px',
        color: '#8b6340',
        textTransform: 'uppercase',
        letterSpacing: '2.5px',
        marginTop: '6px',
        fontWeight: '600',
      },
      statDivider: {
        width: '2px',
        height: '56px',
        backgroundColor: '#c4a574',
        borderRadius: '2px',
      },
      shareButton: {
        padding: '18px 56px',
        fontSize: '15px',
        fontFamily: "'Libre Baskerville', Georgia, serif",
        fontWeight: '700',
        backgroundColor: '#6b3410',
        color: '#fdfbf7',
        border: 'none',
        borderRadius: '14px',
        cursor: 'pointer',
        letterSpacing: '3px',
        textTransform: 'uppercase',
        marginBottom: '56px',
        boxShadow: '0 5px 0 #4a2309, 0 8px 24px rgba(107, 52, 16, 0.3)',
        transition: 'all 0.2s ease',
      },
      newsletterForm: {
        width: '100%',
        textAlign: 'center',
        marginBottom: '40px',
      },
      newsletterLabel: {
        fontSize: '13px',
        color: '#6b3410',
        fontWeight: '600',
        marginBottom: '12px',
        letterSpacing: '0.5px',
      },
      newsletterRow: {
        display: 'flex',
        gap: '8px',
        justifyContent: 'center',
      },
      newsletterInput: {
        padding: '10px 14px',
        fontSize: '14px',
        fontFamily: "'Libre Baskerville', Georgia, serif",
        border: '2px solid #c4a574',
        borderRadius: '8px',
        backgroundColor: '#ffffff',
        color: '#6b3410',
        outline: 'none',
        flex: '1',
        maxWidth: '220px',
      },
      newsletterButton: {
        padding: '10px 18px',
        fontSize: '13px',
        fontFamily: "'Libre Baskerville', Georgia, serif",
        fontWeight: '600',
        backgroundColor: '#6b3410',
        color: '#fdfbf7',
        border: 'none',
        borderRadius: '8px',
        cursor: 'pointer',
        letterSpacing: '0.5px',
        whiteSpace: 'nowrap',
      },
      newsletterNote: {
        fontSize: '11px',
        color: '#b8956d',
        marginTop: '8px',
      },
      answersReview: {
        textAlign: 'left',
        padding: '28px',
        backgroundColor: 'rgba(255, 255, 255, 0.9)',
        borderRadius: '18px',
        border: '2px solid #c4a574',
        boxShadow: '0 6px 24px rgba(107, 52, 16, 0.12)',
      },
      reviewTitle: {
        fontSize: '11px',
        color: '#8b6340',
        textTransform: 'uppercase',
        letterSpacing: '2.5px',
        marginBottom: '18px',
        fontWeight: '700',
      },
      reviewStartCategory: {
        fontSize: '13px',
        color: '#8b6340',
        fontStyle: 'italic',
        marginBottom: '12px',
        opacity: '0.9',
      },
      reviewItem: {
        marginBottom: '16px',
      },
      reviewAnswer: {
        color: '#6b3410',
        fontWeight: '600',
        fontFamily: "'IBM Plex Mono', monospace",
        letterSpacing: '1.5px',
        fontSize: '17px',
        display: 'block',
      },
      reviewBridge: {
        color: '#8b6340',
        fontSize: '13px',
        fontStyle: 'italic',
        display: 'block',
        marginTop: '4px',
        paddingLeft: '12px',
        borderLeft: '3px solid #c4a574',
        opacity: '0.85',
      },
    };

    // Add keyframe animations via style tag
    const styleSheet = document.createElement('style');
    styleSheet.textContent = `
      @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap');

      @keyframes shake {
        0%, 100% { transform: translateX(0) translateY(5px); }
        20% { transform: translateX(-10px) translateY(5px); }
        40% { transform: translateX(10px) translateY(5px); }
        60% { transform: translateX(-6px) translateY(5px); }
        80% { transform: translateX(6px) translateY(5px); }
      }

      @keyframes popIn {
        0% {
          opacity: 0;
          transform: scale(0.4);
        }
        60% {
          transform: scale(1.05);
        }
        100% {
          opacity: 1;
          transform: scale(1);
        }
      }

      @keyframes scaleIn {
        0% {
          transform: scale(1.1);
        }
        100% {
          transform: scale(1);
        }
      }

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(15px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      * {
        -webkit-tap-highlight-color: transparent;
      }

      /* Visible focus ring for keyboard navigation */
      button:focus-visible, input:focus-visible {
        outline: 3px solid #6b3410;
        outline-offset: 2px;
      }

      button:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 7px 0 #8b4513, 0 12px 28px rgba(107, 52, 16, 0.25) !important;
      }

      button:active:not(:disabled) {
        transform: translateY(5px);
        box-shadow: none !important;
      }

      .chainImageWrapperSmall:hover,
      .chainImageWrapperTiny:hover {
        transform: scale(1.1);
      }

      /* Mobile responsive */
      .statsRow { flex-wrap: wrap; }
      .revealWord { word-break: break-word; }
      .revealOthers { flex-wrap: wrap; justify-content: center; }
      .newsletterRow { flex-wrap: wrap; }

      @media (max-width: 400px) {
        .statsRow { gap: 20px !important; }
        .statsRow .statValue { font-size: 32px !important; }
        .revealWord { font-size: 24px !important; letter-spacing: 2px !important; }
        .optionBtn { padding: 18px 14px !important; font-size: 20px !important; }
        .newsletterRow { flex-direction: column; align-items: stretch; }
        .newsletterRow input { max-width: none !important; }
      }
    `;
    document.head.appendChild(styleSheet);

    // Render the app
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<CNMN />);
  </script>
  <script data-goatcounter="https://cnmn.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
</body>
</html>
